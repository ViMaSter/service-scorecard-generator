<!-- !!! THIS FILE IS AUTOGENERATED - DO NOT EDIT IT MANUALLY !!! -->
<!-- !!! THIS FILE IS AUTOGENERATED - DO NOT EDIT IT MANUALLY !!! -->
<!-- !!! THIS FILE IS AUTOGENERATED - DO NOT EDIT IT MANUALLY !!! -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@headline</title>
    <style type="text/css">
        :root
        {
            --palette-accent1: 241, 112, 123;
            --palette-accent2: 146, 195, 83;
            --palette-accent3: 253, 185, 19;
            --status-warning-icon-foreground: 177, 133, 37;
            --status-info-foreground: 97, 168, 255;
        }

        li, a {
            color: rgba(152, 198, 255,1);
            text-decoration: none;
        }
        li:hover, a:hover {
            color: rgba(184, 216, 255,1);
            text-decoration: none;
        }

        * {
            box-sizing: border-box;
        }

        html, body
        {
            background: rgb(32 31 30);
            color: rgba(255, 255, 255, 0.95);
            font-family: "Segoe UI VSS (Regular)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", Helvetica, Ubuntu, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        }
        table{
            border-collapse: collapse;
            border-spacing: 0;
        }
        td,th
        {
            padding: 10px 13px;
            border: 1px solid rgba(59, 58, 57, 1);
        }
        th
        {
            background: rgb(37 36 35);
            color: rgba(255, 255, 255, 0.8);
            text-align: left;
            font-weight: 600;
            padding: 13px 11px;
        }
        tr:nth-child(odd) td
        {
            background: rgb(30 29 28);
        }
        tr:nth-child(even) td
        {
            background: rgb(32 31 30);
        }
        
        .edit-dialog:empty
        {
            display: none;
        }
        
        .edit-dialog
        {
            position: fixed;
            top: 10em;
            right: 5em;
            display: flex;
            flex-direction: column;
            line-height: 2rem;
            background-color: rgba(255, 255, 255, 0.05);
            padding: 1em;
            z-index: 100;
        }

        button {
            align-items: center;
            border-radius: 2px;
            border: 1px solid transparent;
            cursor: pointer;
            display: inline-flex;
            flex-direction: row;
            flex-shrink: 0;
            font-family: inherit;
            font-size: inherit;
            font-weight: 600;
            justify-content: center;
            line-height: inherit;
            outline: none;
            overflow: visible;
            padding: 6px 12px;
            position: relative;
            transition: background 80ms linear;
            background-color:  rgba(255, 255, 255, 0.08);
            color: white;
            margin: 0;
        }
        button:hover {
            background-color: rgba(255,255,255,.18);
        }
        button:active {
            background-color: rgba(255,255,255,.2);
        }
    </style>
    <script type="text/javascript">
        const DESC = "DESC";
        const ASC = "ASC";

        const stripArrows = (text) => {
            return text.replace(/( ↓| ↑|☰| ?)/g, "");
        };

        let storage = null;
        const generateStorage = (filterContainer, table) => {
            const findHeaderRow = () => {
                return Array.from(table.querySelectorAll("tr")).find(row => {
                    return Array.from(row.querySelectorAll("td, th")).every(cell => cell.colSpan == 1);
                });
            };
            const headerRow = findHeaderRow(table);
            const rowsBeforeHeaderRow = Array.from(table.querySelectorAll("tr")).filter(row => Array.prototype.indexOf.call(row.parentNode.children, row) < Array.prototype.indexOf.call(row.parentNode.children, headerRow));
            const rowsAfterHeaderRow = Array.from(table.querySelectorAll("tr")).filter(row => Array.prototype.indexOf.call(row.parentNode.children, row) > Array.prototype.indexOf.call(row.parentNode.children, headerRow));
            const filters = Array.from(headerRow.querySelectorAll("td, th")).reduce((acc, cell) => {
                const orderBy = stripArrows(cell.textContent);
                const values = Array.from(new Set(Array.from(rowsAfterHeaderRow).map(row => row.querySelectorAll("td, th").item(Array.from(headerRow.querySelectorAll("td, th")).findIndex(cell => cell.textContent == orderBy)).textContent)));
                acc[cell.textContent] = values;
                return acc;
            }, {});

            return {
                filterContainer,
                table,
                rowsBeforeHeaderRow,
                headerRow,
                rowsAfterHeaderRow,
                filters,
                order: DESC,
                orderBy: "Average"
            };
        };

        const cloneElement = (element) => {
            const clone = element.cloneNode(true);
            return clone;
        };

        const order = (orderByColumnIndex, order) => {
            return (rowA, rowB) => {
                if (rowA.querySelectorAll("td, th").item(orderByColumnIndex).textContent == "n/a") return order == DESC ? 1 : -1;
                if (rowB.querySelectorAll("td, th").item(orderByColumnIndex).textContent == "n/a") return order == DESC ? -1 : 1;

                const rowAContentAsInteger = parseInt(rowA.querySelectorAll("td, th").item(orderByColumnIndex).textContent);
                const rowBContentAsInteger = parseInt(rowB.querySelectorAll("td, th").item(orderByColumnIndex).textContent);
                if (isNaN(rowAContentAsInteger) || isNaN(rowBContentAsInteger)) {
                    const rowAContentAsString = rowA.querySelectorAll("td, th").item(orderByColumnIndex).textContent;
                    const rowBContentAsString = rowB.querySelectorAll("td, th").item(orderByColumnIndex).textContent;
                    if (rowAContentAsString > rowBContentAsString) return order == DESC ? -1 : 1;
                    if (rowAContentAsString < rowBContentAsString) return order == DESC ? 1 : -1;
                    return 0;
                }
                if (rowAContentAsInteger > rowBContentAsInteger) return order == DESC ? -1 : 1;
                if (rowAContentAsInteger < rowBContentAsInteger) return order == DESC ? 1 : -1;
                return 0;
            }
        };

        const matchesFilter = (row) => {
            return Object.entries(storage.filters).every(([orderBy, allowedValues]) => {
                const cell = row.querySelectorAll("td, th").item(Array.from(storage.headerRow.querySelectorAll("td, th")).findIndex(cell => cell.textContent == orderBy));
                return allowedValues.includes(cell.textContent);
            });
        };

        const addClickHandler = (headerRow) => {
            const cells = Array.from(headerRow.querySelectorAll("td, th"));
            cells.forEach(cell => {
                cell.addEventListener("click", (event) => {
                    const column = cell;
                    const columnIndex = Array.from(column.parentNode.children).indexOf(column);
                    const orderBy = stripArrows(column.textContent);
                    const order = storage.orderBy == orderBy && storage.order == DESC ? ASC : DESC;
                    storage.orderBy = orderBy;
                    storage.orderByColumnIndex = columnIndex;
                    storage.order = order;
                    fromStorage();
                });
            });
            cells.forEach(cell => cell.style.cursor = "pointer");
            cells.forEach(cell => {
                const orderBy = cell.textContent;
                const filterButton = document.createElement("span");
                filterButton.textContent = "☰";
                filterButton.style.position = "absolute";
                filterButton.style.top = "0";
                filterButton.style.left = "0";
                filterButton.style.zIndex = "2";
                filterButton.addEventListener("click", (event) => {
                    storage.filterContainer.innerHTML = "";

                    const values = Array.from(new Set(Array.from(storage.rowsAfterHeaderRow).map(row => row.querySelectorAll("td, th").item(Array.from(storage.headerRow.querySelectorAll("td, th")).findIndex(cell => cell.textContent == orderBy)).textContent))).sort((a, b) => {
                        const aAsInteger = parseInt(a);
                        const bAsInteger = parseInt(b);
                        if (isNaN(aAsInteger) || isNaN(bAsInteger)) {
                            if (a > b) return 1;
                            if (a < b) return -1;
                            return 0;
                        }
                        return bAsInteger - aAsInteger;
                    });

                    const checkboxes = values.map(value => {
                        const checkbox = document.createElement("input");
                        checkbox.type = "checkbox";
                        checkbox.name = value;
                        checkbox.dataset.tableFilter = orderBy;
                        checkbox.checked = storage.filters[orderBy] && storage.filters[orderBy].includes(value);
                        checkbox.addEventListener("change", (event) => {
                            storage.filters[orderBy] = Array.from(document.querySelectorAll(`input[data-table-filter="${orderBy}"]`)).filter(checkbox => checkbox.checked).map(checkbox => checkbox.name);
                            fromStorage();
                        });
                        const label = document.createElement("label");
                        label.appendChild(checkbox);
                        label.appendChild(document.createTextNode(stripArrows(value)));
                        return label;
                    });

                    const closeButton = document.createElement("button");
                    closeButton.textContent = "Close";
                    closeButton.addEventListener("click", (event) => {
                        storage.filterContainer.remove();
                        fromStorage();
                        console.log({ storage });
                    });
                    storage.filterContainer.appendChild(closeButton);
                    checkboxes.forEach(checkbox => storage.filterContainer.appendChild(checkbox));
                    document.body.appendChild(storage.filterContainer);
                    event.stopPropagation();
                    event.preventDefault();
                    return false;
                });
                cell.appendChild(filterButton);

                if (storage.orderBy == orderBy) {
                    const arrow = document.createElement("span");
                    arrow.style.position = "absolute";
                    arrow.style.top = "0";
                    arrow.style.right = "0";
                    arrow.textContent = storage.order == DESC ? " ↓" : " ↑";
                    cell.appendChild(arrow);
                }
            });

            return headerRow;
        };

        const makeChildrenRelativePosition = (element) => {
            Array.from(element.children).forEach(child => {
                child.style.position = "relative";
            });
            return element;
        };

        const makeSticky = (element) => {
            Array.from(element.querySelectorAll("td, th")).forEach(cell => {
                cell.style.position = "sticky";
                cell.style.zIndex = "1";
                cell.style.top = Array.from(cell.parentNode.children).filter(child => Array.prototype.indexOf.call(child.parentNode.children, child) < Array.prototype.indexOf.call(child.parentNode.children, cell)).reduce((acc, child) => acc + child.offsetHeight, 0) + "px";
            });
            return element;
        };

        const fromStorage = () => {
            storage.table.innerHTML = "";
            storage.table.style.position = "relative";
            storage.rowsBeforeHeaderRow.forEach(row => makeSticky(makeChildrenRelativePosition(cloneElement(storage.table.appendChild(row)))));
            storage.table.appendChild(addClickHandler(makeSticky(makeChildrenRelativePosition(cloneElement(storage.headerRow)))));
            const orderByColumnIndex = Array.from(storage.headerRow.querySelectorAll("td, th")).findIndex(cell => cell.textContent == storage.orderBy);
            storage.rowsAfterHeaderRow.filter(matchesFilter).sort(order(orderByColumnIndex, storage.order)).forEach(row => cloneElement(storage.table.appendChild(row)));
        };

        window.addEventListener("load", ()=> {
            storage = generateStorage(document.querySelector(".edit-dialog"), document.querySelector("table"));
            fromStorage();
        });
    </script>
</head>
<body>
    <h1>@headline</h1>
    <noscript><h2>@lastUpdatedAt</h2></noscript>
    <h2 id="dynamic"></h2>
    
    <div>
        <p>Hover over cells for details.</p>
        <p>Information on how to reach 100 points for each check can be found in the child pages:</p></div>
    <ul>
        @lists
    </ul>

    @table
    <div class="edit-dialog"></div>
    <script type="text/javascript">
        const data = @data;
        const lastUpdatedAt = "@lastUpdatedAt";
        document.getElementById("dynamic").innerHTML = Intl.DateTimeFormat(navigator.language, {
            dateStyle: "full",
            timeStyle: "long"
        }).format(new Date(lastUpdatedAt));
    <script>
</body>
</html>